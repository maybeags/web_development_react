# useState 복습 및 응용

## useState란?

: 함수형 컴포넌트 내에서 state를 사용할 수 있게 해주는 '기본 hook.'

### state

: React 내에서의 state란 데이터가 관리 및 저장되는 공간.

#### class 및 funciton component의 대조

```jsx
// 클래스형 컴포넌트
class Product extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      price: 1000;
    };
  }
}

// 함수형 컴포넌트
function Product() {
  const [price, setPrice] = useState(1000);;
}
```

- 이상의 코드에서 함수형 컴포넌트와 클래스형 컴포넌트 안에서 state를 사용한 예시를 확인할 수 있는데, 함수형 컴포넌트에서는 usteState Hook을 사용하여 첫 번째 argument인 변수 price에 상태 값으로 1000의 initialValue를 넣어주었습니다.

- 반면에, 클래스형 컴포넌트는 this.price = { price : 1000 };을 사용하여 price를 1000으로 초기화해주었습니다.

- state는 JS의 객체이며, 컴포넌트 안에서 관리됩니다. 컴포넌트는 자신의 state를 props를 통해 자식 컴포넌트에 전달하고 영향을 끼칠 수 있습니다. state를 가진 컴포넌트 외에 다른 컴포넌트는 접근할 수 없기 때문에 local, 혹은 캡슐화(encapsulation)이라고 부르기도 합니다.

* props

: props도 속성을 나타나는 데이터이면서, JS의 객체입니다. '컴포넌트 안에서 관리되는 state'와 다르게 '컴포넌트에 전달한다'는 방식 상의 차이가 있습니다.

- React 컴포넌트들은 자신의 props를 자체적으로 수정해서는 안되며, 입력값에 대한 결과가 변함없이 동일한 순 함수처럼 동작해야 합니다.

```jsx
function Introduece(props) {
  return <h1>나는 {props.color}색을 좋아해!</h1>
}

const root =
  ReactDOM.createRoot(document.getElementById('root'));
  const element = <Introduce color='초록' />;

root.render(element);
```

1. <Introduce color='초록' />; element로 root.render()를 호출합니다.
2. props로 {color: '초록'} 단일 객체를 Introduce 컴포넌트에 호출되어 전달 받고, 화면에는 Introduce 컴포넌트가 반환한 값, 즉 '나는 초록색을 좋아해!'가 나타납니다.

- 이상의 경우에서 해당 컴포넌트에 단일 객체로 전달한다는 표현이 있는데 이 '단일 객체'가 props에 해당합니다.

### setState

: 이상에서 state는 컴포넌트 안에서 관리되고 있는 저장되는 공간이라고 확인했습니다. state의 값을 갱신하기 위해서 함수형 컴포넌트와 클래스형 컴포넌트에서는 'setState' 함수를 이용합니다. 

형식 :

```jsx
<button onClick={ () => this.setState({price: this.state.price + 100})}>
가격 인상↑
</button>
```
클래스형 컴포넌트에서의 this.setState의 사용 예시

- React의 기본 Hook에 해당하는 setState 함수를 통해 '새 state 값을 반환받아서 컴포넌트 리렌더링을 큐에 등록하고 최신 state로 갱신'해줍니다. 또한 props와 동일하게 setState 함수로 동일성이라는 특징을 갖고 있어, '리렌더링 시에 변경되지 않습니다.'

### useState

이상까지의 예시들은 클래스 컴포넌트를 포함하여 설명이 이루어졌습니다. React Hook이 등장하기 전에, 함수 컴포넌트 안에서는 state 사용이 불가능했기 때문인데, 이제는 React 기본 Hook인 useState의 등장으로 함수 컴포넌트 안에서도 state를 사용할 수 있습니다.

- 이제 명심하셔야 할 것은 state와 useState는 다른 개념이었다는 점입니다.

useState의 특징 :

1. 상태를 유지하는 값인 state 변수와 그 값을 갱신하는 setState 함수를 쌍으로 반환.
2. useState 호출 시, 컴포넌트 state는 완전히 독립적으로 이루어져 작동됨.
3. 함수형 컴포넌트에서는 state의 initialValue로 객체를 포함한, 배열, 문자, 숫자 타입을 가질 수 있으며, 하나의 컴포넌트 안에서 여러 개의 useState Hook을 사용 가능.

```jsx
function Person() {
  const [ age, setAge ] = useState(18);         // number
  const [ grade, setGrade ] = useStatge('A');   // string
  const [ todos, setTodos ] = useState({subject: 'Math'});  // 배열 / 객체
  const [ check, setCheck ] = useState(false);  // boolean
  // 기타 추가 필드를 집어넣을 수 있을텐데, 이렇게 한 줄이 필드 및 setter 겠죠.
}
```
## useState를 사용하는 이유

: React에서 상태를 관리할 때 일반 변수가 아닌 state 변수를 활용하는 이유로는 DOM 렌더링과 밀접한 연관이 있습니다.

### 일반 변수를 사용 했을 때

: 예를 들어 버튼을 클릭할 때 마다 마신 물이 몇 잔인지 기록한다고 가정했을 때, 버튼의 클릭 횟수에 따라 변하는 상태를 저장할 수 있도록 일반 변수인 drink를 0으로 초기화하고, 버튼을 클릭하여 drinkWater 함수를 호출하면 drink 변수에 클릭 횟수가 누적되도록 하고, 출력할겁니다.

```jsx
function App() {
  let drink = 0;  // 일반 변수 사용

  const drinkWater = () => {
    drink += 1;
    console.log(`버튼 클릭 횟수 : ${drink}번`);
  };

  return (
    <>
      <p>
        🔋 오늘은 물을 <strong> {drink} </strong> 잔을 충전했습니다!!😀
      </p>
      <br/><br/><br/>
      <button onClick={drinkWater}>🧊</button>
    </>
  );
}

export default App;
```
이상의 코드를 App10.jsx를 붙여넣고, 실행할 수 있도록 모든 과정을 작성하시오.

터미널에서도 써야하는 명령어 있을겁니다. -> npm run dev : React project를 실행시키는 명령어

이상을 해결했을 때, 콘솔창에서의 drink값이 변동이 있지만, 실제 화면에서는 변경된 값이 렌더링이 이루어지지 않고 있습니다.

이유 :

- 컴포넌트가 DOM에서 렌더링 될 때 생명주기 이벤트가 발생하는 것에 있습니다. 함수 컴포넌트 안에서 '일반 변수는 렌더링 될 때마다 초기화되지만', state 변수를 사용하는 경우 변경된 값을 반영하여 업데이트해주기 때문입니다.

### State 변수를 사용하게 됐을 때

- 그렇다면 useState를 사용하여 drink의 상태를 저장하게 됐을 경우

```jsx
import { useState } from 'react';

function App() {
  const [drink, setDrink] = useState(0);

  const drinkWater = () => {
    setDrink(drink + 1);
  };

  return (
    <>
      <p>
        🔋 오늘은 물을 <strong> {drink} </strong> 잔을 충전했습니다!!😀
      </p>
      <br/><br/><br/>
      <button onClick={drinkWater}>🧊</button>
      {console.log(`버튼 클릭 횟수 : ${drink}번`)}
    </>
  );  
}

export default App;
```

### React가 useState 사용을 권장하는 이유 

: 함수 컴포넌트는 state 변경으로 리렌더링이 되면 컴포넌트 내부에 있는 변수들이 모두 초기화가 이루어집니다. 기존의 컴포넌트가 새로고침되는 것이 아니고, state의 최신 상태를 새로운 컴포넌트로 갱신해주는 것에 가깝다고 볼 수 있습니다.

useState는 상태 주기 메서드와 state를 함수 컴포넌트에서 사용할 수 있게 만들어주고, 함수의 특성을 활용하여 현재 산태 값을 가지고 있는 state 변수와 값을 변경시켜주는 setState 함수를 사용하여 배열을 반환해줍니다.

```jsx
const [state, setState] = useState(initialValue);
```

App11.jsx 생성하고 실습하겠습니다.

- 버튼을 클릭할 때마다 화면이 리렌더링 되면서 count 횟수가 증가합니다.
- 콘솔창을 통해 컴포넌트가 렌더링되고 count 변수의 값이 갱신되는데, 해당 과정을 풀이하자면

1. 처음 서버를 실행했을 때, 컴포넌트가 렌더링되고 초깃값이 담긴 count를 출력(저희는 f5를 통해서)
2. 이후 버튼을 클릭하면 setCount 함수가 호출되고 현재 시점의 count를 출력합니다.
  - 렌더링 전의 count : 0 (해당 부분이 현재 시점의 count)
3. 렌더링이 된 후, 현재 시점의 count 값을 출력
  - 현재 count : 1 (이 부분이 바뀌고 난 부분이 됩니다.)

  느낌표\[임시이름](경로)

  ![img](./flowChart.webp)